document.addEventListener("DOMContentLoaded",(function(event){const listAdminContainer=document.querySelector("div#list-admin-container"),listAdminLoading=listAdminContainer.querySelector("span#loading-list"),listAdminEmptyMessage=listAdminContainer.querySelector(".list-admin-empty-message"),listGroupElement=listAdminContainer.querySelector("div.list-group"),dialogDataElement=document.querySelectorAll(".selected-data"),angkaText=document.querySelector("#total-admin"),totalPendingText=document.querySelector("#total-pending");function countDataAdmin(listParent){angkaText.textContent=listParent.children.length.toString(),totalPendingText.textContent=listGroupElement.querySelectorAll("a.approve-admin").length.toString()}async function getListAdmin(){try{listAdminLoading.classList.remove("d-none");const response=await fetch(`${BASEURL}/dataadmin/getListAdmin`);if(listAdminLoading.classList.add("d-none"),!response.ok)throw Error();const responseJson=await response.json();if(!responseJson)throw Error();if(renderListAdmin(responseJson),countDataAdmin(listGroupElement),0!==Object.keys(responseJson).length){toggleListEmpty("hide");const listAdmin=new List("list-admin",{valueNames:["nama","last-added","status"]});listAdmin.sort("status",{order:"desc"}),listAdmin.on("searchComplete",(function(){0===listAdmin.matchingItems.length?toggleListEmpty("show","search","Hasil pencarian tidak ditemukan","Coba masukkan kata kunci lain yang lebih umum."):toggleListEmpty("hide")}))}else toggleListEmpty("show","emoji-frown","Tidak ada admin disini","Admin yang baru mendaftar akan muncul disini.")}catch(error){listAdminLoading.classList.add("d-none"),toggleListEmpty("show","x-circle","Gagal memuat daftar admin","Coba lagi nanti atau refresh halaman ini."),console.error(error)}}function renderListAdmin(dataAdmin){listGroupElement.innerHTML="",dataAdmin.forEach(admin=>{let badgeStatus="",btnApproveDisplay="";"pending"===admin.status_user?(badgeStatus=`<p class="badge badge-warning p-1 my-1 status">${admin.status_user}</p>`,btnApproveDisplay=`<a href="${BASEURL}/dataadmin/approveadmin/${admin.id_admin}" class="btn btn-primary my-1 approve-admin" data-id-admin="${admin.id_admin}" data-nama-admin="${admin.nama_admin}">Setujui</a>`):"admin"===admin.status_user&&(badgeStatus=`<p class="badge badge-success p-1 my-1 status">${admin.status_user}</p>`),listGroupElement.insertAdjacentHTML("beforeend",`\n<div class="list-group-item anim-fade">\n    <div class="row">\n    <div class="col-12 col-lg-8">\n    <h5 class="nama">${admin.nama_admin}</h5>\n    ${badgeStatus}\n    <p class="d-none last-added">${admin.id_admin}</p>\n    </div>\n    <div class="col-md my-2">\n    ${btnApproveDisplay}\n    <button class="btn btn-outline-danger my-1" data-toggle="modal" data-target="#dialogHapus" data-id-admin="${admin.id_admin}" data-nama-admin="${admin.nama_admin}">Hapus</button><br>\n    </div>\n    </div>\n</div>`)}),listGroupElement.querySelectorAll("button[data-toggle=modal]").forEach(btn=>{btn.addEventListener("click",(function(){dialogDataElement.forEach(element=>{"A"==element.tagName?element.setAttribute("href",`${BASEURL}/dataadmin/hapus/${btn.getAttribute("data-id-admin")}`):element.textContent=btn.getAttribute("data-nama-admin")})}))})}function toggleListEmpty(toggle,iconName="",messageTitle="",messageDetail=""){switch(toggle){case"show":listAdminEmptyMessage.classList.replace("d-none","d-flex"),listAdminEmptyMessage.children[0].querySelector("use").setAttribute("href",`${BASEURL}/assets/img/bootstrap-icons-1.2.1/bootstrap-icons.svg#${iconName}`),listAdminEmptyMessage.children[1].textContent=messageTitle,listAdminEmptyMessage.children[2].textContent=messageDetail;break;case"hide":listAdminEmptyMessage.classList.replace("d-flex","d-none")}}document.querySelector("a#btn-refresh").addEventListener("click",(function(){getListAdmin()})),getListAdmin()}));