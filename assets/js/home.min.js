document.addEventListener("DOMContentLoaded",(function(event){const segeraBerakhirList=document.querySelector(".segera-berakhir").querySelector(".list-group"),sewaTerbaruList=document.querySelector(".sewa-terbaru").querySelector(".list-group"),btnTryAgain=document.querySelectorAll("button.try-again"),dt=luxon.DateTime;async function getListTop5(listElement,url="",btnTryAgainIndex=0){const noListElement=listElement.querySelector(".no-list");try{noListElement.classList.remove(".d-none"),noListElement.textContent="Memuat...";const response=await fetch(`${BASEURL}/home/${url}`);if(!response.ok)throw Error();const responseJson=await response.json();if(!responseJson)throw Error();0===Object.keys(responseJson).length?(noListElement.classList.remove("d-none"),noListElement.textContent="Tidak ada data"):(noListElement.classList.add("d-none"),btnTryAgain[btnTryAgainIndex].classList.add("d-none"),listElement==segeraBerakhirList?renderListSegeraBerakhir(responseJson):listElement==sewaTerbaruList&&renderListSewaTerbaru(responseJson))}catch(error){noListElement.textContent="Error: Tidak dapat memuat daftar.",noListElement.classList.remove("d-none"),btnTryAgain[btnTryAgainIndex].classList.remove("d-none")}}function renderListSegeraBerakhir(data){segeraBerakhirList.innerHTML="",data.forEach(item=>{segeraBerakhirList.insertAdjacentHTML("beforeend",`<a href="${BASEURL}/datasewaan/details/viewdetail/${item.id_pesanan}" class="list-group-item list-group-item-action">\n    <h5>${item.id_pesanan.toUpperCase()} - ${item.nama_pemesan}</h5>\n    <p class="text-secondary m-0">Berakhir <span class="days-text">${formatDate(item.tgl_selesai,dt.DATE_MED)} ${formatTime(item.waktu_selesai)}</span></p>\n</a>`)})}function renderListSewaTerbaru(data){sewaTerbaruList.innerHTML="",data.forEach(item=>{sewaTerbaruList.insertAdjacentHTML("beforeend",`<a href="${BASEURL}/datasewaan/details/viewdetail/${item.id_pesanan}" class="list-group-item list-group-item-action">\n    <h5>${item.id_pesanan.toUpperCase()} - ${item.nama_pemesan}</h5>\n    <p class="text-secondary m-0">${formatDate(item.tgl_mulai,dt.DATE_MED)} ${formatTime(item.waktu_mulai)} - ${formatDate(item.tgl_selesai,dt.DATE_MED)} ${formatTime(item.waktu_selesai)}</p>\n</a>`)})}btnTryAgain.forEach(btn=>{btn.classList.contains("sewa-terbaru")?btn.addEventListener("click",(function(){getListTop5(sewaTerbaruList,"getsewaterbaru",0)})):btn.classList.contains("segera-berakhir")&&btn.addEventListener("click",(function(){getListTop5(segeraBerakhirList,"getsewaakanberakhir",1)}))}),getListTop5(segeraBerakhirList,"getsewaakanberakhir",1),getListTop5(sewaTerbaruList,"getsewaterbaru",0)}));