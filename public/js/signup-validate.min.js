const forms=document.forms[0],inputs={nama_admin:document.querySelector("input#nama_admin"),username:document.querySelector("input#username"),password:document.querySelector("input#password"),repassword:document.querySelector("input#repassword")};async function isUsernameAlreadyExists(){try{const response=await fetch("http://localhost/sewaterop/public/signup/getUsername",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`username=${inputs.username.value}`});if(!response.ok)throw Error();const responseText=await response.text();if(1==responseText)inputs.username.classList.add("is-invalid"),inputs.username.nextElementSibling.innerText="Username ini sudah terdaftar.";else{if(0!=responseText)throw Error();inputs.username.classList.replace("is-invalid","is-valid")}}catch(error){inputs.username.classList.replace("is-valid","is-invalid"),inputs.username.nextElementSibling.innerText="Tidak dapat memeriksa ketersediaan username."}}inputs.nama_admin.addEventListener("input",(function(){inputs.nama_admin.validity.valid?inputs.nama_admin.classList.remove("is-invalid"):(inputs.nama_admin.validity.valueMissing&&(inputs.nama_admin.nextElementSibling.innerText="Harap masukkan nama"),inputs.nama_admin.classList.add("is-invalid"))})),inputs.username.addEventListener("input",(function(){inputs.username.validity.valid?isUsernameAlreadyExists():(inputs.username.validity.valueMissing?inputs.username.nextElementSibling.innerText="Harap masukkan username":inputs.username.validity.patternMismatch&&(inputs.username.nextElementSibling.innerText="Username harus terdiri dari huruf dan angka."),inputs.username.classList.add("is-invalid"))})),inputs.password.addEventListener("input",(function(){inputs.password.validity.valid?inputs.password.classList.replace("is-invalid","is-valid"):(inputs.password.validity.valueMissing?inputs.password.nextElementSibling.innerText="Harap masukkan password":inputs.password.validity.patternMismatch?inputs.password.nextElementSibling.innerText="Password harus terdiri dari huruf dan angka.":inputs.password.validity.tooShort&&(inputs.password.nextElementSibling.innerText="Password harus minimal 8 karakter."),inputs.password.classList.add("is-invalid"))})),inputs.repassword.addEventListener("input",(function(){inputs.repassword.validity.valid?inputs.repassword.value!=inputs.password.value?(inputs.repassword.nextElementSibling.innerText="Password tidak cocok. Coba lagi.",inputs.repassword.classList.add("is-invalid")):inputs.repassword.classList.replace("is-invalid","is-valid"):(inputs.repassword.validity.valueMissing&&(inputs.repassword.nextElementSibling.innerText="Harap masukkan password"),inputs.repassword.classList.add("is-invalid"))})),forms.addEventListener("submit",(function(event){for(input in inputs)inputs[input].validity.valid&&!inputs[input].classList.contains("is-invalid")||event.preventDefault()}));